<!DOCTYPE html>
<html>
<head>
    <title>Главная страница</title>
    <script>
        async function updateIsRead(bookId, isReadCheckbox) {
            const isRead = isReadCheckbox.checked;
            const response = await fetch(`/update_is_read/${bookId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ is_read: isRead })
            });
            const data = await response.json();
            if (!data.success) {
                alert('Ошибка при сохранении статуса книги');
            }
        }
    </script>
</head>
<body>
    <h1>Последние книги</h1>
    <ul>
        {% for book in books %}
        <li>
            {{ book.title }} - Жанр: <a href="{{ url_for('genre_view', genre_id=book.genre_id) }}">{{ book.genre.name }}</a>
            <input type="checkbox" onchange="updateIsRead({{ book.id }}, this)" {% if book.is_read %}checked{% endif %}>
        </li>
        {% endfor %}
    </ul>
</body>
</html>